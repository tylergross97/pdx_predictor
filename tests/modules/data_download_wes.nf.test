nextflow_process {

    name "Test Process DATA_DOWNLOAD_WES"
    script "modules/data_download_wes.nf"
    process "DATA_DOWNLOAD_WES"

    test("Should run without failures") {

        when {
            process {
                """
                input[0] = file("${projectDir}/test/data/ccrcc_wes_samplesheet.csv")
                """
            }
        }

        then {
            def output = process.out.vcf_files[0]
            assert output.size() == 4, "Expected 4 VCF files to be downloaded, but got ${output.size()}"
            output.each { vcf_path ->
                def vcf_file = path(vcf_path)
                // println("Checking file: ${vcf_file}")
                def vcf = vcf_file.vcf
                println("VCF file summary for ${vcf_file}: ${vcf.summary}")
            }
        }

    }

}
